---
import { getCollection } from 'astro:content'

const projects = await getCollection('projects');
const sortedProjects = projects.sort((a, b) => a.data.order - b.data.order);
const hasMore = sortedProjects.length > 3;
---

<section class="space-y-8">
  <h2 class="text-section-mobile md:text-section font-serif font-semibold">
    Projects
  </h2>
  <div class="space-y-6">
    {
      sortedProjects.map((project, index) => (
        <article class:list={['space-y-1', { 'md:hidden': index >= 3 }]}>
          <h3 class="text-display-mobile md:text-display font-serif font-semibold">
            {project.data.title}
          </h3>
          <p class="text-body text-text-secondary dark:text-text-secondary-dark leading-relaxed max-w-prose">
            {project.data.description}
          </p>
          <a
            href={project.data.link}
            target="_blank"
            rel="noopener noreferrer"
            class="link text-small inline-block"
          >
            â†’ View Project
          </a>
        </article>
      ))
    }
  </div>
  {
    hasMore && (
      <a href="/projects" class="link md:inline-block hidden">
        View All Projects
      </a>
    )
  }
</section>
